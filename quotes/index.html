
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How much will my fence cost? | Perth Fencing Price Guide</title>

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:title" content="How much will my fence cost? | Perth Fencing Price Guide">
<meta property="og:description" content="Get a ballpark fencing price in 60 seconds. Colorbond, aluminium, timber &amp; more. No login, no spam â€” just numbers.">
<meta property="og:url" content="https://itabs.ai/quotes/">
<meta property="og:image" content="https://itabs.ai/quotes/og-fencing.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="How much will my fence cost? | Perth Fencing Price Guide">
<meta name="twitter:description" content="Get a ballpark fencing price in 60 seconds. Colorbond, aluminium, timber &amp; more. No login, no spam â€” just numbers.">
<meta name="twitter:image" content="https://itabs.ai/quotes/og-fencing.png">

<!-- General -->
<meta name="description" content="Free fencing quote estimator for Perth. Colorbond, aluminium slat, timber, pool &amp; security fencing. Get a ballpark price in 60 seconds â€” no sign-up needed.">
<meta name="theme-color" content="#f59e0b">

<script>
const WIDGET_CONFIG = {

  business: {
    name: "Perth Fencing Price Guide",
    tagline: "",
    phone: "",
    email: "",
    logo: "",
    website: "",
    location: "Perth, WA",
    socials: {}
  },

  branding: {
    mode: "dark",
    primaryColor: "#f59e0b",
    secondaryColor: "#d97706",
    backgroundColor: "#0c1117",
    cardBackground: "#151c25",
    hoverBackground: "#1a2332",
    darkBackground: "#0a0e14",
    borderColor: "#222d3a",
    textColor: "#e8ecf1",
    mutedText: "#8896a7",
    dimText: "#5a6a7d",
    successColor: "#22c55e",
    errorColor: "#ef4444",
    infoColor: "#3b82f6",
    googleFontsUrl: "https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap",
    fontFamily: "'Plus Jakarta Sans', sans-serif",
    monoFont: "'JetBrains Mono', monospace",
    borderRadius: "14px",
  },

  header: {
    icon: "ğŸ—ï¸",
    headline: "How much will my fence cost?",
    subtitle: "Answer a few questions and get a ballpark price in 60 seconds. No login. No spam. Just numbers.",
    badge: "Free estimator Â· Perth metro Â· Updated 2026",
  },

  steps: [
    {
      id: "fence_type",
      title: "What type of fence?",
      preview: "Tap to choose",
      input: {
        type: "select",
        options: [
          { value: "colorbond", label: "Colorbond", icon: "ğŸŸ¢", description: "Most popular â€” steel, durable, low maintenance" },
          { value: "aluminium", label: "Aluminium Slat", icon: "â¬œ", description: "Modern look â€” privacy with airflow" },
          { value: "timber", label: "Timber / Pinelap", icon: "ğŸªµ", description: "Classic look â€” natural, budget-friendly" },
          { value: "pool", label: "Pool Fencing", icon: "ğŸŠ", description: "Glass or aluminium â€” must meet AS1926.1" },
          { value: "security", label: "Security Fencing", icon: "ğŸ”’", description: "Chain mesh, garrison â€” residential & commercial" },

        ]
      },
      hints: [
        {
          tabLabel: "Compare Types",
          type: "comparison_table",
          columns: ["Type", "Durability", "Privacy", "Price"],
          rows: [
            ["Colorbond", "â­â­â­â­â­", "â­â­â­â­â­", "$$"],
            ["Aluminium Slat", "â­â­â­â­â­", "â­â­â­â­", "$$$"],
            ["Timber / Pinelap", "â­â­â­", "â­â­â­â­", "$"],
            ["Pool (Glass)", "â­â­â­â­", "â­", "$$$$"],
            ["Pool (Aluminium)", "â­â­â­â­â­", "â­â­", "$$$"],
            ["Security", "â­â­â­â­â­", "â­â­", "$$"],

          ]
        },
        {
          tabLabel: "Perth Tips",
          type: "mixed",
          content: [
            {
              type: "key_point",
              label: "ğŸŒŠ Coastal suburbs?",
              text: "If you're in Scarborough, Cottesloe, Fremantle or any coastal area, consider aluminium or Colorbond with marine-grade fixings. Salt air corrodes standard steel and destroys timber."
            },
            {
              type: "key_point",
              label: "ğŸ”¥ Bushfire zone?",
              text: "Colorbond is non-combustible and meets BAL ratings. Timber fencing is not recommended in bushfire-prone areas. Check your BAL rating with your local council."
            },
            {
              type: "tip",
              icon: "ğŸ’¡",
              title: "Not sure which to pick?",
              text: "Colorbond is the most popular choice in Perth for good reason â€” it handles the climate, looks clean, comes in heaps of colours, and lasts 20+ years with zero maintenance."
            },

          ]
        }
      ]
    },

    {
      id: "colorbond_colour",
      title: "What colour?",
      preview: "Tap to choose",
      showIf: { step: "fence_type", value: "colorbond" },
      input: {
        type: "select",
        options: [
          { value: "surfmist", label: "Surfmist", icon: "â¬œ", description: "Light off-white â€” bright, clean, popular for front fences" },
          { value: "paperbark", label: "Paperbark", icon: "ğŸŸ¡", description: "Warm cream â€” classic Perth favourite" },
          { value: "evening_haze", label: "Evening Haze", icon: "ğŸ©¶", description: "Warm light grey â€” modern neutral" },
          { value: "shale_grey", label: "Shale Grey", icon: "ğŸ©¶", description: "Cool mid-grey â€” very popular" },
          { value: "woodland_grey", label: "Woodland Grey", icon: "ğŸŸ¤", description: "Dark warm grey â€” contemporary look" },
          { value: "basalt", label: "Basalt", icon: "â¬›", description: "Dark charcoal â€” bold, modern" },
          { value: "monument", label: "Monument", icon: "â¬›", description: "Near-black â€” sleek, premium feel" },
          { value: "night_sky", label: "Night Sky", icon: "â¬›", description: "Deepest dark â€” dramatic statement" },
          { value: "pale_eucalypt", label: "Pale Eucalypt", icon: "ğŸŸ¢", description: "Muted green â€” blends with gardens" },
          { value: "jasper", label: "Jasper", icon: "ğŸŸ¤", description: "Warm brown â€” earthy, natural tone" },
          { value: "domain", label: "Domain", icon: "ğŸŸ¤", description: "Sandy beige â€” suits limestone homes" },
          { value: "not_sure", label: "Not sure yet", icon: "ğŸ¤·", description: "No worries â€” your fencer can show you samples" },
        ]
      },
      hints: [
        {
          tabLabel: "Popular in Perth",
          type: "mixed",
          content: [
            {
              type: "tip",
              icon: "ğŸ’¡",
              title: "Most popular colours",
              text: "In Perth, the top picks are Monument, Woodland Grey, and Basalt for modern homes. Paperbark and Surfmist are classics that go with everything."
            },
            {
              type: "key_point",
              label: "ğŸ¨ Can't decide?",
              text: "Pick 'Not sure yet' and your fencer can bring colour samples to show you on site. Colours can look different in person vs on a screen."
            }
          ]
        }
      ]
    },

    {
      id: "size",
      title: "How much fencing?",
      preview: "Length & height",
      input: {
        type: "slider_group",
        sliders: [
          {
            id: "length_m",
            label: "Length",
            unit: "m",
            min: 5, max: 80, step: 1, default: 20,
            valueMap: null,
          },
          {
            id: "height_m",
            label: "Height",
            unit: "",
            min: 0, max: 3, step: 1, default: 2,
            valueMap: [
              { value: 0, label: "0.9m (low)", numericValue: 0.9 },
              { value: 1, label: "1.2m (front fence)", numericValue: 1.2 },
              { value: 2, label: "1.8m (standard)", numericValue: 1.8 },
              { value: 3, label: "2.1m (extra tall)", numericValue: 2.1 },
            ],
          }
        ]
      },
      hints: [
        {
          tabLabel: "Measuring Tips",
          type: "mixed",
          content: [
            {
              type: "tip",
              icon: "ğŸ“",
              title: "Don't stress about exact measurements",
              text: "A rough idea is fine for a ballpark price. Walk along the fence line and count your steps â€” each step is roughly 0.7m. Your fencer will do an exact measure on site."
            },
            {
              type: "tip",
              icon: "ğŸ’¡",
              title: "Different heights for front and sides?",
              text: "Most homes have a shorter front fence and taller side/rear fences. Just run this estimator once for each section and add the totals together."
            },
            {
              type: "key_point",
              label: "ğŸ“ Standard heights",
              text: "Most side & rear fences are 1.8m. Front fences are usually 0.9mâ€“1.2m (check your council). Pool fences must be at least 1.2m by law."
            }
          ]
        },
        {
          tabLabel: "Dividing Fences",
          type: "mixed",
          content: [
            {
              type: "key_point",
              label: "ğŸ  WA Dividing Fences Act 1961",
              text: "In Western Australia, neighbours generally share the cost of a dividing fence 50/50. You can serve a Fencing Notice on your neighbour to start the process."
            },
            {
              type: "tip",
              icon: "ğŸ’¡",
              title: "Good to know",
              text: "Have a friendly chat with your neighbour first before going the legal route. Most people are reasonable when you explain the costs and show them options."
            }
          ]
        }
      ],
      warnings: [
        {
          condition: "answers.fence_type === 'pool' && getSliderNumeric('height_m') < 1.2",
          icon: "âš ï¸",
          title: "Pool fencing minimum 1.2m",
          text: "By Australian law (AS1926.1), pool fencing must be at least 1.2m high. Heights below this won't pass inspection.",
          style: "error"
        }
      ]
    },

    {
      id: "extras",
      title: "Any extras?",
      preview: "Gates, removal, etc",
      input: {
        type: "toggle_group",
        toggles: [
          { id: "gate", label: "Single pedestrian gate", icon: "ğŸšª", costHint: "Adds ~$350â€“$600" },
          { id: "drivegate", label: "Double/driveway gate", icon: "ğŸš—", costHint: "Adds ~$800â€“$1,500" },
          { id: "removal", label: "Old fence removal", icon: "ğŸ—‘ï¸", costHint: "Adds ~$15â€“$30/m" },
          { id: "asbestos", label: "Asbestos fence removal (licensed)", icon: "â˜¢ï¸", costHint: "Adds ~$35â€“$60/m" },
          { id: "slope", label: "Sloping block (stepped)", icon: "ğŸ“", costHint: "Adds ~10â€“20% to labour" },
          { id: "plinth", label: "Plinth (gap filler under fence)", icon: "ğŸ§±", costHint: "Adds ~$15â€“$25/m" },
          { id: "lattice", label: "Lattice/slat top extension", icon: "ğŸŒ¿", costHint: "Adds ~$20â€“$35/m" },
        ]
      },
      hints: [
        {
          tabLabel: "What's Included?",
          type: "mixed",
          content: [
            {
              type: "paragraph",
              text: "A standard fencing quote typically includes: posts, rails, panels, cement for footings, and installation on flat ground. Here's what might cost extra:"
            },
            {
              type: "key_point",
              label: "â˜¢ï¸ Asbestos fence (Super 6)?",
              text: "If your old fence is asbestos (very common in Perth), it MUST be removed by a licensed contractor. Unlicensed removal can result in fines up to $50,000 in WA. Make sure your fencer is licensed for this."
            },
            {
              type: "key_point",
              label: "ğŸª¨ Hitting rock or limestone?",
              text: "Common in Perth â€” especially north of the river. If posts can't be dug in by hand, core drilling is needed at ~$10â€“$20 per post hole. Your fencer will check on site."
            },
            {
              type: "key_point",
              label: "ğŸ§± Need a retaining wall too?",
              text: "Retaining walls are usually quoted separately as they require engineering. Mention it when you contact your fencer so they can price it up on site."
            }
          ]
        }
      ]
    },
  ],

  estimate: {
    title: "Your ballpark price",
    preview: "Based on your selections",
    note: "Supply & install â€¢ incl. GST â€¢ Perth metro â€¢ Prices based on 2026 averages",
    hints: [
      {
        type: "key_point",
        label: "How accurate is this?",
        text: "This is a rough guide based on average Perth pricing in 2026. Your actual quote depends on soil type, access, specific materials, and the installer. Always get at least 2-3 quotes from local fencers."
      },
      {
        type: "tip",
        icon: "ğŸ’¡",
        title: "Pro tip",
        text: "When you send this to a fencer, they'll love you. Instead of saying 'how much for a fence?' you'll have all your specs ready â€” fence type, height, length, and extras. It saves everyone time and gets you a faster, more accurate quote."
      }
    ]
  },

  pricing: {
    unit: "metre",
    unitLabel: "per metre",
    basePriceStep: "fence_type",
    basePrices: {
      colorbond:  { low: 95, high: 130 },
      aluminium:  { low: 180, high: 300 },
      timber:     { low: 120, high: 200 },
      pool:       { low: 200, high: 600 },
      security:   { low: 110, high: 250 },

    },
    quantitySource: "length_m",
    multipliers: [
      {
        source: "height_m",
        type: "value_map",
        values: { 0.9: 0.65, 1.2: 0.8, 1.8: 1.0, 2.1: 1.15 }
      }
    ],
    extras: [
      { id: "gate", type: "fixed", low: 350, high: 600, breakdownLabel: "Pedestrian gate" },
      { id: "drivegate", type: "fixed", low: 800, high: 1500, breakdownLabel: "Driveway gate" },
      { id: "removal", type: "per_unit", lowPerUnit: 15, highPerUnit: 30, breakdownLabel: "Old fence removal" },
      { id: "asbestos", type: "per_unit", lowPerUnit: 35, highPerUnit: 60, breakdownLabel: "Asbestos removal (licensed)" },
      { id: "slope", type: "percentage", lowPercent: 10, highPercent: 20, breakdownLabel: "Sloping block" },
      { id: "plinth", type: "per_unit", lowPerUnit: 15, highPerUnit: 25, breakdownLabel: "Plinths" },
      { id: "lattice", type: "per_unit", lowPerUnit: 20, highPerUnit: 35, breakdownLabel: "Lattice top" },
    ],
    showBreakdown: true,
    displayMode: "from",
    roundTo: 0,
    minimumPrice: 500,
  },

  // Replace lead capture with "Ready to Quote" share feature
  leadCapture: {
    enabled: true,
    title: "Ready to quote?",
    preview: "Get your specs to send",
    heading: "Your fence specs â€” ready to send",
    subheading: "Copy your quote summary below and send it to any local fencer. You'll get a faster, more accurate quote because they'll know exactly what you need.",
    showSummary: true,
    fields: [
      { id: "name", label: "Your name (optional)", type: "text", placeholder: "e.g. Dave", required: false },
      { id: "suburb", label: "Suburb (helps with pricing)", type: "text", placeholder: "e.g. Joondalup, Kingsley, Scarborough", required: false },
      { id: "notes", label: "Anything else? (optional)", type: "textarea", placeholder: "e.g. Access from back lane, need to match neighbour's fence, old fence is asbestos...", required: false },
    ],
    submitText: "ğŸ“‹ Copy My Quote to Clipboard",
    submitNote: "",
    successMessage: "Copied to clipboard! âœ…",
    successSubtext: "Paste it into a text, email, or DM to any local fencer. They'll have everything they need to give you an accurate quote.",
    delivery: {
      method: "clipboard",
    }
  },

  socialProof: {
    enabled: false,
  },

  // Notification â€” sends a copy to you when someone copies/emails a quote
  // Get your free access key at https://web3forms.com (enter responses@itabs.ai)
  notification: {
    enabled: true,
    web3formsKey: "99a11c15-5c61-4765-99c5-673adec64b16",  // Replace with your Web3Forms access key
    toEmail: "responses@itabs.ai",
  },

  footer: {
    showPoweredBy: true,
    poweredByUrl: "https://itabs.ai",
  }
};
</script>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ENGINE â€” Everything below here is generic. Do not edit per client.
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<script>
// Load Google Fonts from config
if (WIDGET_CONFIG.branding.googleFontsUrl) {
  const link = document.createElement('link');
  link.rel = 'stylesheet';
  link.href = WIDGET_CONFIG.branding.googleFontsUrl;
  document.head.appendChild(link);
  const preconnect = document.createElement('link');
  preconnect.rel = 'preconnect';
  preconnect.href = 'https://fonts.googleapis.com';
  document.head.prepend(preconnect);
}
document.title = WIDGET_CONFIG.header.headline + ' | ' + WIDGET_CONFIG.business.name;
</script>

<style>
:root {
  --bg-main: #0c1117;
  --bg-card: #151c25;
  --bg-hover: #1a2332;
  --bg-dark: #0a0e14;
  --border: #222d3a;
  --brand-primary: #f59e0b;
  --brand-secondary: #d97706;
  --brand-glow: rgba(245, 158, 11, 0.15);
  --accent-green: #22c55e;
  --accent-blue: #3b82f6;
  --accent-red: #ef4444;
  --text-primary: #e8ecf1;
  --text-secondary: #8896a7;
  --text-muted: #5a6a7d;
  --font-main: 'Plus Jakarta Sans', sans-serif;
  --font-mono: 'JetBrains Mono', monospace;
  --radius: 14px;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: var(--font-main);
  background: var(--bg-main);
  color: var(--text-primary);
  min-height: 100vh;
  -webkit-font-smoothing: antialiased;
}

.container {
  max-width: 520px;
  margin: 0 auto;
  padding: 20px 16px 40px;
}

/* â•â•â• HEADER â•â•â• */
.header { text-align: center; padding: 30px 0 25px; }
.header-icon { font-size: 2.5rem; margin-bottom: 12px; }
.header h1 {
  font-size: 1.6rem; font-weight: 800; margin-bottom: 6px;
  background: linear-gradient(135deg, var(--brand-primary), #fbbf24);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
}
.header p { color: var(--text-secondary); font-size: 0.95rem; line-height: 1.5; }
.header .badge-line {
  display: inline-block; background: var(--bg-card); border: 1px solid var(--border);
  padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; color: var(--text-muted); margin-top: 12px;
}

/* â•â•â• PROGRESS â•â•â• */
.progress-label {
  display: flex; justify-content: space-between; margin-bottom: 8px;
  font-size: 0.75rem; color: var(--text-muted);
}
.progress-bar {
  background: var(--bg-card); border-radius: 10px; height: 6px; margin-bottom: 25px; overflow: hidden;
}
.progress-fill {
  height: 100%; background: linear-gradient(90deg, var(--brand-primary), var(--brand-secondary));
  border-radius: 10px; width: 0%; transition: width 0.5s ease;
}

/* â•â•â• ACCORDION SECTIONS â•â•â• */
.itab-section {
  background: var(--bg-card); border-radius: var(--radius); margin-bottom: 14px;
  overflow: hidden; border: 1px solid var(--border); transition: all 0.3s ease; scroll-margin-top: 16px;
}
.itab-section:hover { border-color: rgba(245, 158, 11, 0.3); }
.itab-section.completed { border-color: var(--accent-green); }
.itab-section.completed .itab-number { background: var(--accent-green); }

.itab-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 18px 16px; cursor: pointer; transition: background 0.2s;
}
.itab-header:hover { background: var(--bg-hover); }

.itab-title { display: flex; align-items: center; gap: 12px; }
.itab-number {
  width: 34px; height: 34px;
  background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
  border-radius: 10px; display: flex; align-items: center; justify-content: center;
  font-weight: 700; font-size: 0.85rem; color: #000; flex-shrink: 0;
}
.itab-name { font-size: 1rem; font-weight: 600; }
.itab-preview { font-size: 0.8rem; color: var(--text-muted); margin-top: 2px; }
.itab-preview .selected { color: var(--accent-green); font-weight: 500; }

.i-button {
  width: 32px; height: 32px;
  background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
  border: none; border-radius: 8px; color: #000; font-weight: 700; font-size: 1rem;
  cursor: pointer; transition: all 0.2s; font-family: serif; font-style: italic; flex-shrink: 0;
}
.i-button:hover { transform: scale(1.1); box-shadow: 0 0 20px var(--brand-glow); }
.i-button.active { background: var(--accent-green); color: white; }

.itab-content { display: none; padding: 0 16px 18px; border-top: 1px solid var(--border); }
.itab-content.show { display: block; animation: fadeInUp 0.3s ease; }

/* â•â•â• TABS â•â•â• */
.tabs {
  display: flex; gap: 6px; padding: 14px 0; border-bottom: 1px solid var(--border);
  margin-bottom: 14px; flex-wrap: wrap;
}
.tab {
  padding: 7px 14px; background: var(--bg-hover); border: none; border-radius: 8px;
  color: var(--text-secondary); cursor: pointer; font-family: var(--font-main);
  font-size: 0.85rem; font-weight: 500; transition: all 0.2s;
}
.tab:hover { color: var(--text-primary); }
.tab.active {
  background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
  color: #000; font-weight: 600;
}
.tab-panel { display: none; }
.tab-panel.show { display: block; }
.tab-panel h3 { color: var(--brand-primary); margin-bottom: 10px; font-size: 1rem; }
.tab-panel p { color: var(--text-secondary); margin-bottom: 12px; line-height: 1.6; font-size: 0.9rem; }

/* â•â•â• SELECT OPTIONS â•â•â• */
.option-grid { display: grid; gap: 10px; margin: 10px 0; }
.option-grid.cols-2 { grid-template-columns: 1fr 1fr; }
.option-card {
  background: var(--bg-dark); border: 2px solid var(--border); border-radius: 12px;
  padding: 16px; cursor: pointer; transition: all 0.2s;
}
.option-card:hover { border-color: var(--brand-primary); background: var(--bg-hover); }
.option-card.selected { border-color: var(--accent-green); background: rgba(34, 197, 94, 0.05); }
.option-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
.option-name { font-weight: 700; font-size: 1rem; }
.option-price { font-family: var(--font-mono); font-size: 0.85rem; color: var(--brand-primary); font-weight: 500; }
.option-desc { color: var(--text-muted); font-size: 0.82rem; line-height: 1.5; }
.option-check { display: none; color: var(--accent-green); font-weight: 700; font-size: 0.85rem; margin-top: 6px; }
.option-card.selected .option-check { display: inline; }
.option-tags { display: flex; gap: 6px; margin-top: 8px; flex-wrap: wrap; }
.option-tag {
  font-size: 0.7rem; padding: 3px 8px; border-radius: 6px;
  background: var(--bg-hover); color: var(--text-muted);
}
.option-tag.highlight { background: rgba(245, 158, 11, 0.15); color: var(--brand-primary); }

/* â•â•â• SLIDERS â•â•â• */
.slider-group { margin: 16px 0; }
.slider-label { display: flex; justify-content: space-between; margin-bottom: 8px; }
.slider-label span { color: var(--text-secondary); font-size: 0.9rem; }
.slider-value { font-family: var(--font-mono); color: var(--brand-primary); font-weight: 600; }
input[type="range"] {
  width: 100%; -webkit-appearance: none; appearance: none;
  height: 8px; background: var(--bg-dark); border-radius: 4px; outline: none;
}
input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none; width: 24px; height: 24px;
  background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
  border-radius: 50%; cursor: pointer; box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
}
input[type="range"]::-moz-range-thumb {
  width: 24px; height: 24px;
  background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
  border-radius: 50%; cursor: pointer; border: none;
}

/* â•â•â• TOGGLES â•â•â• */
.toggle-row {
  display: flex; justify-content: space-between; align-items: center;
  padding: 14px 0; border-bottom: 1px solid var(--border);
}
.toggle-row:last-child { border-bottom: none; }
.toggle-info .toggle-name { font-weight: 600; font-size: 0.9rem; margin-bottom: 2px; }
.toggle-info .toggle-cost { font-size: 0.8rem; color: var(--text-muted); }
.toggle-switch {
  width: 48px; height: 26px; background: var(--bg-dark); border-radius: 13px;
  border: 2px solid var(--border); cursor: pointer; position: relative;
  transition: all 0.3s; flex-shrink: 0;
}
.toggle-switch.on { background: var(--accent-green); border-color: var(--accent-green); }
.toggle-knob {
  width: 18px; height: 18px; background: white; border-radius: 50%;
  position: absolute; top: 2px; left: 2px; transition: all 0.3s;
}
.toggle-switch.on .toggle-knob { left: 24px; }

/* â•â•â• ESTIMATE BOX â•â•â• */
.estimate-box {
  background: linear-gradient(135deg, rgba(245, 158, 11, 0.08), rgba(217, 119, 6, 0.05));
  border: 2px solid var(--brand-primary); border-radius: var(--radius);
  padding: 24px; margin: 20px 0; text-align: center;
}
.est-label { color: var(--text-muted); font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; }
.est-range { font-family: var(--font-mono); font-size: 2rem; font-weight: 700; color: var(--brand-primary); margin-bottom: 4px; }
.est-note { color: var(--text-muted); font-size: 0.78rem; }
.estimate-breakdown { margin-top: 16px; text-align: left; }
.breakdown-row {
  display: flex; justify-content: space-between; padding: 8px 0;
  border-bottom: 1px solid rgba(245, 158, 11, 0.1); font-size: 0.85rem;
}
.breakdown-row:last-child { border-bottom: none; }
.breakdown-row .br-label { color: var(--text-secondary); }
.breakdown-row .br-value { font-family: var(--font-mono); color: var(--text-primary); font-weight: 500; }

/* â•â•â• KEY POINTS & TIPS â•â•â• */
.key-point {
  background: var(--bg-dark); border-left: 4px solid var(--brand-primary);
  padding: 12px 16px; margin: 12px 0; border-radius: 0 8px 8px 0;
}
.key-point .kp-label {
  color: var(--brand-primary); font-weight: 600; font-size: 0.75rem;
  text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 4px;
}
.key-point p { color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 0; }

.tip-card {
  background: rgba(59, 130, 246, 0.08); border: 1px solid rgba(59, 130, 246, 0.2);
  border-radius: 10px; padding: 12px 14px; margin: 10px 0; font-size: 0.85rem;
}
.tip-card .tip-title { font-weight: 600; color: var(--accent-blue); margin-bottom: 4px; }
.tip-card p { color: var(--text-secondary); margin-bottom: 0; font-size: 0.83rem; }

.warning-card {
  border: 1px solid rgba(239,68,68,0.3); background: rgba(239,68,68,0.08);
  border-radius: 10px; padding: 12px 14px; margin: 10px 0; font-size: 0.85rem;
}
.warning-card .warning-title { font-weight: 600; color: var(--accent-red); margin-bottom: 4px; }
.warning-card p { color: var(--text-secondary); margin-bottom: 0; font-size: 0.83rem; }

/* â•â•â• COMPARISON TABLE â•â•â• */
.compare-table { width: 100%; border-collapse: collapse; margin: 12px 0; font-size: 0.82rem; }
.compare-table th {
  text-align: left; padding: 10px 8px; color: var(--text-muted); font-weight: 600;
  border-bottom: 2px solid var(--border); font-size: 0.75rem;
  text-transform: uppercase; letter-spacing: 0.5px;
}
.compare-table td { padding: 10px 8px; color: var(--text-secondary); border-bottom: 1px solid var(--border); }
.compare-table td:first-child { font-weight: 600; color: var(--text-primary); }

/* â•â•â• LEAD/SHARE FORM â•â•â• */
.form-group { margin-bottom: 12px; text-align: left; }
.form-group label { display: block; color: var(--text-muted); font-size: 0.8rem; margin-bottom: 4px; font-weight: 500; }
.form-group input, .form-group textarea {
  width: 100%; padding: 12px; background: var(--bg-dark); border: 1px solid var(--border);
  border-radius: 8px; color: var(--text-primary); font-family: var(--font-main);
  font-size: 0.9rem; outline: none; transition: border-color 0.2s;
}
.form-group input:focus, .form-group textarea:focus { border-color: var(--brand-primary); }
.form-group textarea { resize: vertical; min-height: 70px; }

.submit-btn {
  width: 100%; padding: 14px;
  background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
  border: none; border-radius: 10px; color: #000; font-family: var(--font-main);
  font-size: 1rem; font-weight: 700; cursor: pointer; transition: all 0.2s; margin-top: 8px;
}
.submit-btn:hover { transform: translateY(-1px); box-shadow: 0 4px 20px var(--brand-glow); }
.submit-btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }

.email-btn {
  width: 100%; padding: 14px;
  background: transparent;
  border: 2px solid var(--brand-primary); border-radius: 10px; color: var(--brand-primary);
  font-family: var(--font-main);
  font-size: 1rem; font-weight: 700; cursor: pointer; transition: all 0.2s; margin-top: 8px;
}
.email-btn:hover { background: rgba(245, 158, 11, 0.1); transform: translateY(-1px); }

.summary-box {
  background: var(--bg-dark); border: 1px solid var(--border); border-radius: 10px;
  padding: 14px; margin-bottom: 16px; font-size: 0.83rem;
}
.summary-label {
  font-weight: 600; color: var(--brand-primary); margin-bottom: 8px;
  font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.5px;
}
.summary-content { color: var(--text-secondary); line-height: 1.8; }

.success-message { text-align: center; padding: 30px 20px; animation: fadeInUp 0.4s ease; }
.success-message .check-icon { font-size: 3rem; margin-bottom: 12px; }
.success-message h3 { color: var(--accent-green); margin-bottom: 8px; }
.success-message p { color: var(--text-secondary); font-size: 0.9rem; }

/* â•â•â• CONTACT CARD â•â•â• */
.contact-card {
  display: flex; flex-wrap: wrap; justify-content: center; align-items: center;
  gap: 8px; padding: 10px 16px; margin-bottom: 20px; font-size: 0.82rem;
}
.contact-card a, .contact-card .cc-item {
  color: var(--text-secondary); text-decoration: none;
  display: inline-flex; align-items: center; gap: 5px;
  padding: 5px 12px; border-radius: 20px;
  background: rgba(255,255,255,0.03); border: 1px solid var(--border);
  transition: all 0.2s ease; white-space: nowrap;
}
.contact-card a:hover {
  background: rgba(255,255,255,0.07); border-color: var(--brand-primary);
  color: var(--brand-primary);
}

/* â•â•â• READY TO QUOTE BANNER â•â•â• */
.rtq-banner {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(34, 197, 94, 0.05));
  border: 1px solid rgba(34, 197, 94, 0.3);
  border-radius: 10px; padding: 16px; margin: 16px 0; text-align: center;
}
.rtq-banner h4 { color: var(--accent-green); font-size: 0.95rem; margin-bottom: 6px; }
.rtq-banner p { color: var(--text-secondary); font-size: 0.82rem; line-height: 1.5; }

/* â•â•â• FOOTER â•â•â• */
.powered-by {
  text-align: center; padding: 30px 0 10px; font-size: 0.75rem; color: var(--text-muted);
}
.powered-by a { color: var(--brand-primary); text-decoration: none; font-weight: 600; }

/* â•â•â• ANIMATIONS â•â•â• */
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}
</style>
</head>
<body>

<div class="container" id="app">
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// iTabs Quotes Engine v1.1 â€” with Ready to Quote sharing
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const C = WIDGET_CONFIG;

// â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const state = {
  answers: {},
  sliders: {},
  toggles: {},
  openSection: null,
  completedSections: new Set(),
};

// â”€â”€ APPLY BRANDING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function applyBranding() {
  const b = C.branding;
  const r = document.documentElement.style;
  r.setProperty('--bg-main', b.backgroundColor);
  r.setProperty('--bg-card', b.cardBackground);
  r.setProperty('--bg-hover', b.hoverBackground);
  r.setProperty('--bg-dark', b.darkBackground);
  r.setProperty('--border', b.borderColor);
  r.setProperty('--brand-primary', b.primaryColor);
  r.setProperty('--brand-secondary', b.secondaryColor);
  r.setProperty('--text-primary', b.textColor);
  r.setProperty('--text-secondary', b.mutedText);
  r.setProperty('--text-muted', b.dimText);
  r.setProperty('--accent-green', b.successColor);
  r.setProperty('--accent-red', b.errorColor);
  r.setProperty('--accent-blue', b.infoColor);
  r.setProperty('--font-main', b.fontFamily);
  r.setProperty('--font-mono', b.monoFont);
  r.setProperty('--radius', b.borderRadius);
}

// â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function init() {
  applyBranding();
  initSliderDefaults();
  render();
  updateConditionalSteps();
  setTimeout(() => toggleSection(0), 1500);
}

function initSliderDefaults() {
  C.steps.forEach(step => {
    if (step.input.type === 'slider_group') {
      step.input.sliders.forEach(s => {
        const raw = s.default;
        if (s.valueMap) {
          const mapped = s.valueMap.find(v => v.value === raw);
          state.sliders[s.id] = {
            raw, numeric: mapped ? mapped.numericValue : raw, label: mapped ? mapped.label : raw + (s.unit || '')
          };
        } else {
          state.sliders[s.id] = { raw, numeric: raw, label: raw + (s.unit || '') };
        }
      });
    }
    if (step.input.type === 'toggle_group') {
      step.input.toggles.forEach(t => { state.toggles[t.id] = false; });
    }
  });
}

// â”€â”€ RENDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function render() {
  const app = document.getElementById('app');
  let html = '';

  html += renderHeader();
  if (C.socialProof && C.socialProof.enabled) html += renderSocialProof();
  html += renderContactCard();

  const totalSections = C.steps.length + (C.estimate ? 1 : 0) + (C.leadCapture && C.leadCapture.enabled ? 1 : 0);
  html += `
    <div class="progress-label">
      <span>Your quote</span>
      <span id="progressText">0 of ${totalSections}</span>
    </div>
    <div class="progress-bar">
      <div class="progress-fill" id="progressFill"></div>
    </div>`;

  C.steps.forEach((step, i) => { html += renderSection(step, i); });
  if (C.estimate) html += renderEstimateSection(C.steps.length);
  if (C.leadCapture && C.leadCapture.enabled) html += renderLeadSection(C.steps.length + (C.estimate ? 1 : 0));

  if (C.footer && C.footer.showPoweredBy) {
    html += `<div class="powered-by">Powered by <a href="${C.footer.poweredByUrl}" target="_blank">iTabs</a> Â· Interactive tools that convert</div>`;
  }

  app.innerHTML = html;
}

function renderHeader() {
  const h = C.header;
  return `
    <div class="header">
      <div class="header-icon">${h.icon}</div>
      <h1>${h.headline}</h1>
      <p>${h.subtitle}</p>
      ${h.badge ? `<span class="badge-line">${h.badge}</span>` : ''}
    </div>`;
}

function renderSocialProof() {
  const sp = C.socialProof;
  const stars = 'â˜…'.repeat(Math.floor(sp.rating));
  return `
    <div class="social-proof">
      <span class="sp-stars">${stars}</span>
      <span class="sp-rating">${sp.rating} from ${sp.reviewCount} reviews</span>
      ${sp.badges.map(b => `<span class="sp-badge">${b}</span>`).join('')}
    </div>`;
}

function renderContactCard() {
  const b = C.business;
  if (!b.phone && !b.website && !b.location) return '';
  let items = [];
  if (b.phone) items.push(`<a href="tel:${b.phone.replace(/\s/g, '')}">ğŸ“ ${b.phone}</a>`);
  if (b.website) {
    const display = b.website.replace(/^https?:\/\//, '').replace(/\/$/, '');
    items.push(`<a href="${b.website}" target="_blank">ğŸŒ ${display}</a>`);
  }
  if (b.location) items.push(`<span class="cc-item">ğŸ“ ${b.location}</span>`);
  return items.length ? `<div class="contact-card">${items.join('')}</div>` : '';
}

// â”€â”€ SECTION RENDERING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderSection(step, index) {
  const sectionId = `section-${index}`;
  const completed = state.completedSections.has(sectionId) ? ' completed' : '';
  const isOpen = state.openSection === sectionId;
  const preview = getPreview(step);

  let contentHtml = '';
  const inputTabLabel = step.input.type === 'toggle_group' ? 'Add Extras' :
                        step.input.type === 'slider_group' ? 'Set Size' : 'Choose';
  const hintTabs = step.hints || [];
  const hasTabs = hintTabs.length > 0;

  if (hasTabs) {
    contentHtml += `<div class="tabs">`;
    contentHtml += `<button class="tab active" onclick="showTab(this, '${sectionId}-input')">${inputTabLabel}</button>`;
    hintTabs.forEach((hint, hi) => {
      contentHtml += `<button class="tab" onclick="showTab(this, '${sectionId}-hint-${hi}')">${hint.tabLabel}</button>`;
    });
    contentHtml += `</div>`;
  }

  contentHtml += `<div class="tab-panel show" id="${sectionId}-input">`;
  contentHtml += renderInput(step, sectionId);
  if (step.warnings) {
    step.warnings.forEach(w => {
      contentHtml += `<div class="warning-card" id="${sectionId}-warning-${w.condition.replace(/[^a-z0-9]/gi,'')}" style="display:none;">
        <div class="warning-title">${w.icon} ${w.title}</div>
        <p>${w.text}</p>
      </div>`;
    });
  }
  contentHtml += `</div>`;

  hintTabs.forEach((hint, hi) => {
    contentHtml += `<div class="tab-panel" id="${sectionId}-hint-${hi}">`;
    contentHtml += renderHint(hint);
    contentHtml += `</div>`;
  });

  return `
    <div class="itab-section${completed}" id="${sectionId}">
      <div class="itab-header" onclick="toggleSection(${index})">
        <div class="itab-title">
          <span class="itab-number">${index + 1}</span>
          <div>
            <div class="itab-name">${step.title}</div>
            <div class="itab-preview" id="${sectionId}-preview">${preview}</div>
          </div>
        </div>
        <button class="i-button" id="${sectionId}-btn">i</button>
      </div>
      <div class="itab-content${isOpen ? ' show' : ''}" id="${sectionId}-content">
        ${contentHtml}
      </div>
    </div>`;
}

function renderEstimateSection(index) {
  const sectionId = `section-${index}`;
  const est = C.estimate;
  const isOpen = state.openSection === sectionId;
  const completed = state.completedSections.has(sectionId) ? ' completed' : '';

  let hintsHtml = '';
  if (est.hints) est.hints.forEach(h => { hintsHtml += renderHintItem(h); });

  return `
    <div class="itab-section${completed}" id="${sectionId}">
      <div class="itab-header" onclick="toggleSection(${index})">
        <div class="itab-title">
          <span class="itab-number">${index + 1}</span>
          <div>
            <div class="itab-name">${est.title}</div>
            <div class="itab-preview" id="${sectionId}-preview">${est.preview}</div>
          </div>
        </div>
        <button class="i-button" id="${sectionId}-btn">i</button>
      </div>
      <div class="itab-content${isOpen ? ' show' : ''}" id="${sectionId}-content">
        <div class="estimate-box">
          <div class="est-label">${C.pricing.displayMode === 'from' ? 'Estimated from' : 'Estimated range'}</div>
          <div class="est-range" id="estRange">â€”</div>
          <div class="est-note" id="estNote">Complete the sections above to see your estimate</div>
          <div class="estimate-breakdown" id="estBreakdown"></div>
        </div>
        ${hintsHtml}
      </div>
    </div>`;
}

function renderLeadSection(index) {
  const sectionId = `section-${index}`;
  const lc = C.leadCapture;
  const isOpen = state.openSection === sectionId;
  const completed = state.completedSections.has(sectionId) ? ' completed' : '';

  let fieldsHtml = '';
  lc.fields.forEach(f => {
    const reqMark = f.required ? ' *' : '';
    if (f.type === 'textarea') {
      fieldsHtml += `<div class="form-group"><label>${f.label}${reqMark}</label><textarea id="form-${f.id}" placeholder="${f.placeholder}"></textarea></div>`;
    } else {
      fieldsHtml += `<div class="form-group"><label>${f.label}${reqMark}</label><input type="${f.type}" id="form-${f.id}" placeholder="${f.placeholder}"></div>`;
    }
  });

  return `
    <div class="itab-section${completed}" id="${sectionId}">
      <div class="itab-header" onclick="toggleSection(${index})">
        <div class="itab-title">
          <span class="itab-number">${index + 1}</span>
          <div>
            <div class="itab-name">${lc.title}</div>
            <div class="itab-preview" id="${sectionId}-preview">${lc.preview}</div>
          </div>
        </div>
        <button class="i-button" id="${sectionId}-btn">i</button>
      </div>
      <div class="itab-content${isOpen ? ' show' : ''}" id="${sectionId}-content">
        <div id="leadFormContainer">
          <div class="rtq-banner">
            <h4>ğŸ“‹ Your fence specs â€” ready to send</h4>
            <p>${lc.subheading}</p>
          </div>
          ${lc.showSummary ? `
            <div class="summary-box">
              <div class="summary-label">Your fence quote summary</div>
              <div class="summary-content" id="quoteSummary">Select your options above first</div>
            </div>` : ''}
          ${fieldsHtml}
          <button class="submit-btn" id="submitBtn" onclick="copyQuote()">${lc.submitText}</button>
          <button class="email-btn" id="emailBtn" onclick="emailQuote()">ğŸ“§ Email This Quote to Myself</button>
        </div>
        <div class="success-message" id="successMsg" style="display:none;">
          <div class="check-icon">âœ…</div>
          <h3 id="successTitle">${lc.successMessage}</h3>
          <p id="successText">${lc.successSubtext}</p>
          <button class="submit-btn" style="margin-top:16px;" onclick="copyQuote()">ğŸ“‹ Copy Again</button>
          <button class="email-btn" onclick="emailQuote()">ğŸ“§ Email This Quote to Myself</button>
          <div id="fencerSuggestions"></div>
        </div>
      </div>
    </div>`;
}

// â”€â”€ INPUT RENDERING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderInput(step, sectionId) {
  const input = step.input;
  switch (input.type) {
    case 'select': return renderSelect(step, sectionId, input);
    case 'multi_select': return renderMultiSelect(step, sectionId, input);
    case 'slider_group': return renderSliders(step, sectionId, input);
    case 'toggle_group': return renderToggles(step, sectionId, input);
    default: return '<p>Unknown input type</p>';
  }
}

function renderSelect(step, sectionId, input) {
  const colsClass = input.columns === 2 ? ' cols-2' : '';
  let html = `<div class="option-grid${colsClass}">`;
  input.options.forEach((opt, i) => {
    const selected = state.answers[step.id] === opt.value ? ' selected' : '';
    const tagsHtml = opt.tags ? opt.tags.map(t =>
      `<span class="option-tag${t.highlight ? ' highlight' : ''}">${t.text}</span>`
    ).join('') : '';
    html += `
      <div class="option-card${selected}" onclick="selectOption('${step.id}', '${opt.value}', ${C.steps.indexOf(step)}, ${input.autoAdvance || false})">
        <div class="option-top">
          <span class="option-name">${opt.icon} ${opt.label}</span>
          ${opt.priceHint ? `<span class="option-price">${opt.priceHint}</span>` : ''}
        </div>
        ${opt.description ? `<div class="option-desc">${opt.description}</div>` : ''}
        ${tagsHtml ? `<div class="option-tags">${tagsHtml}</div>` : ''}
        <span class="option-check">âœ“ Selected</span>
      </div>`;
  });
  html += '</div>';
  return html;
}

function renderMultiSelect(step, sectionId, input) {
  const colsClass = input.columns === 2 ? ' cols-2' : '';
  if (!state.answers[step.id]) state.answers[step.id] = [];
  let html = `<div class="option-grid${colsClass}">`;
  input.options.forEach(opt => {
    const selected = state.answers[step.id].includes(opt.value) ? ' selected' : '';
    html += `
      <div class="option-card${selected}" onclick="toggleMultiOption('${step.id}', '${opt.value}', this)">
        <div class="option-top">
          <span class="option-name">${opt.icon} ${opt.label}</span>
          ${opt.priceHint ? `<span class="option-price">${opt.priceHint}</span>` : ''}
        </div>
        ${opt.description ? `<div class="option-desc">${opt.description}</div>` : ''}
        <span class="option-check">âœ“ Selected</span>
      </div>`;
  });
  html += '</div>';
  return html;
}

function renderSliders(step, sectionId, input) {
  let html = '';
  input.sliders.forEach(s => {
    const current = state.sliders[s.id];
    const displayValue = current ? current.label : s.default + (s.unit || '');
    html += `
      <div class="slider-group">
        <div class="slider-label">
          <span>${s.label}</span>
          <span class="slider-value" id="slider-val-${s.id}">${displayValue}</span>
        </div>
        <input type="range" id="slider-${s.id}" min="${s.min}" max="${s.max}" value="${s.default}" step="${s.step}"
               oninput="updateSlider('${s.id}', '${step.id}', ${C.steps.indexOf(step)}, this.value)">
      </div>`;
  });
  return html;
}

function renderToggles(step, sectionId, input) {
  let html = '';
  input.toggles.forEach(t => {
    const isOn = state.toggles[t.id] ? ' on' : '';
    html += `
      <div class="toggle-row">
        <div class="toggle-info">
          <div class="toggle-name">${t.icon} ${t.label}</div>
          <div class="toggle-cost">${t.costHint}</div>
        </div>
        <div class="toggle-switch${isOn}" id="toggle-${t.id}" onclick="toggleExtra('${t.id}', '${step.id}', ${C.steps.indexOf(step)})">
          <div class="toggle-knob"></div>
        </div>
      </div>`;
  });
  return html;
}

// â”€â”€ HINT RENDERING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderHint(hint) {
  switch (hint.type) {
    case 'comparison_table': return renderComparisonTable(hint);
    case 'tips': return renderTips(hint);
    case 'mixed': return renderMixed(hint);
    case 'custom_html': return hint.content;
    default: return '';
  }
}

function renderComparisonTable(hint) {
  let html = '<table class="compare-table"><thead><tr>';
  hint.columns.forEach(c => { html += `<th>${c}</th>`; });
  html += '</tr></thead><tbody>';
  hint.rows.forEach(row => {
    html += '<tr>';
    row.forEach(cell => { html += `<td>${cell}</td>`; });
    html += '</tr>';
  });
  html += '</tbody></table>';
  return html;
}

function renderTips(hint) {
  return hint.tips.map(t => `
    <div class="tip-card">
      <div class="tip-title">${t.icon} ${t.title}</div>
      <p>${t.text}</p>
    </div>`).join('');
}

function renderMixed(hint) {
  return hint.content.map(item => renderHintItem(item)).join('');
}

function renderHintItem(item) {
  switch (item.type) {
    case 'paragraph':
      return `<p style="color:var(--text-secondary);font-size:0.9rem;line-height:1.6;margin-bottom:12px;">${item.text}</p>`;
    case 'key_point':
      return `<div class="key-point"><div class="kp-label">${item.label}</div><p>${item.text}</p></div>`;
    case 'tip':
      return `<div class="tip-card"><div class="tip-title">${item.icon} ${item.title}</div><p>${item.text}</p></div>`;
    default:
      return '';
  }
}

// â”€â”€ INTERACTIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleSection(index) {
  const sectionId = `section-${index}`;
  const content = document.getElementById(sectionId + '-content');
  const btn = document.getElementById(sectionId + '-btn');
  const isOpen = content && content.classList.contains('show');

  document.querySelectorAll('.itab-content').forEach(c => c.classList.remove('show'));
  document.querySelectorAll('.i-button').forEach(b => b.classList.remove('active'));

  if (!isOpen && content) {
    content.classList.add('show');
    if (btn) btn.classList.add('active');
    state.openSection = sectionId;
    state.completedSections.add(sectionId);
    updateProgress();
    setTimeout(() => {
      document.getElementById(sectionId).scrollIntoView({ behavior: 'smooth', block: 'start' });
    }, 100);
  } else {
    state.openSection = null;
  }
}

function showTab(btn, panelId) {
  const container = btn.closest('.itab-content');
  container.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  container.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('show'));
  btn.classList.add('active');
  document.getElementById(panelId).classList.add('show');
}

function selectOption(stepId, value, stepIndex, autoAdvance) {
  state.answers[stepId] = value;
  const sectionId = `section-${stepIndex}`;
  const section = document.getElementById(sectionId);
  section.querySelectorAll(`#${sectionId}-input .option-card`).forEach(c => c.classList.remove('selected'));
  const cards = section.querySelectorAll(`#${sectionId}-input .option-card`);
  const step = C.steps[stepIndex];
  step.input.options.forEach((opt, i) => {
    if (opt.value === value && cards[i]) cards[i].classList.add('selected');
  });
  section.classList.add('completed');
  state.completedSections.add(sectionId);
  const opt = step.input.options.find(o => o.value === value);
  document.getElementById(sectionId + '-preview').innerHTML = `<span class="selected">âœ“ ${opt ? opt.label : value}</span>`;
  updateEstimate();
  updateQuoteSummary();
  updateProgress();
  checkWarnings();
  updateConditionalSteps();
  if (autoAdvance) {
    let nextIndex = stepIndex + 1;
    while (nextIndex < C.steps.length) {
      const nextSection = document.getElementById(`section-${nextIndex}`);
      if (nextSection && nextSection.style.display !== 'none') break;
      nextIndex++;
    }
    setTimeout(() => toggleSection(nextIndex), 400);
  }
}

// â”€â”€ CONDITIONAL STEPS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateConditionalSteps() {
  C.steps.forEach((step, i) => {
    if (!step.showIf) return;
    const section = document.getElementById(`section-${i}`);
    if (!section) return;
    const visible = state.answers[step.showIf.step] === step.showIf.value;
    section.style.display = visible ? '' : 'none';
    if (!visible) {
      // Clear answer and completion when hidden
      delete state.answers[step.id];
      state.completedSections.delete(`section-${i}`);
      const content = document.getElementById(`section-${i}-content`);
      if (content) content.classList.remove('show');
      section.classList.remove('completed');
      const preview = document.getElementById(`section-${i}-preview`);
      if (preview) preview.textContent = step.preview;
      // Deselect cards
      section.querySelectorAll('.option-card').forEach(c => c.classList.remove('selected'));
    }
  });
  renumberVisibleSteps();
  updateProgress();
  updateEstimate();
  updateQuoteSummary();
}

function renumberVisibleSteps() {
  let visNum = 1;
  C.steps.forEach((step, i) => {
    const section = document.getElementById(`section-${i}`);
    if (!section || section.style.display === 'none') return;
    const numEl = section.querySelector('.itab-number');
    if (numEl) numEl.textContent = visNum;
    visNum++;
  });
  // Renumber estimate and lead sections
  const estIdx = C.steps.length;
  const estSection = document.getElementById(`section-${estIdx}`);
  if (estSection) {
    const numEl = estSection.querySelector('.itab-number');
    if (numEl) numEl.textContent = visNum;
    visNum++;
  }
  const leadIdx = C.steps.length + (C.estimate ? 1 : 0);
  const leadSection = document.getElementById(`section-${leadIdx}`);
  if (leadSection) {
    const numEl = leadSection.querySelector('.itab-number');
    if (numEl) numEl.textContent = visNum;
  }
}

function toggleMultiOption(stepId, value, el) {
  if (!state.answers[stepId]) state.answers[stepId] = [];
  const idx = state.answers[stepId].indexOf(value);
  if (idx > -1) {
    state.answers[stepId].splice(idx, 1);
    el.classList.remove('selected');
  } else {
    state.answers[stepId].push(value);
    el.classList.add('selected');
  }
  updateEstimate();
  updateQuoteSummary();
}

function updateSlider(sliderId, stepId, stepIndex, rawValue) {
  const step = C.steps[stepIndex];
  const sliderConfig = step.input.sliders.find(s => s.id === sliderId);
  const raw = parseFloat(rawValue);
  if (sliderConfig.valueMap) {
    const mapped = sliderConfig.valueMap.find(v => v.value === raw);
    state.sliders[sliderId] = {
      raw, numeric: mapped ? mapped.numericValue : raw, label: mapped ? mapped.label : raw + (sliderConfig.unit || '')
    };
  } else {
    state.sliders[sliderId] = { raw, numeric: raw, label: raw + (sliderConfig.unit || '') };
  }
  document.getElementById(`slider-val-${sliderId}`).textContent = state.sliders[sliderId].label;
  const sectionId = `section-${stepIndex}`;
  document.getElementById(sectionId).classList.add('completed');
  state.completedSections.add(sectionId);
  const previews = step.input.sliders.map(s => {
    const val = state.sliders[s.id];
    if (s.valueMap) return val.numeric + 'm';
    return val.raw + (s.unit || '');
  });
  document.getElementById(sectionId + '-preview').innerHTML = `<span class="selected">âœ“ ${previews.join(' Ã— ')}</span>`;
  updateEstimate();
  updateQuoteSummary();
  updateProgress();
  checkWarnings();
}

function toggleExtra(toggleId, stepId, stepIndex) {
  state.toggles[toggleId] = !state.toggles[toggleId];
  document.getElementById(`toggle-${toggleId}`).classList.toggle('on');
  const sectionId = `section-${stepIndex}`;
  const step = C.steps[stepIndex];
  const activeCount = step.input.toggles.filter(t => state.toggles[t.id]).length;
  if (activeCount > 0) {
    document.getElementById(sectionId + '-preview').innerHTML =
      `<span class="selected">âœ“ ${activeCount} extra${activeCount > 1 ? 's' : ''} added</span>`;
    document.getElementById(sectionId).classList.add('completed');
    state.completedSections.add(sectionId);
  } else {
    document.getElementById(sectionId + '-preview').textContent = step.preview;
    document.getElementById(sectionId).classList.remove('completed');
    state.completedSections.delete(sectionId);
  }
  updateEstimate();
  updateQuoteSummary();
  updateProgress();
}

// â”€â”€ PRICING ENGINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getSliderNumeric(sliderId) {
  return state.sliders[sliderId] ? state.sliders[sliderId].numeric : 0;
}

function calculateEstimate() {
  const p = C.pricing;
  const primaryAnswer = state.answers[p.basePriceStep];
  if (!primaryAnswer || !p.basePrices[primaryAnswer]) return null;
  const base = p.basePrices[primaryAnswer];
  let low = base.low;
  let high = base.high;
  if (p.multipliers) {
    p.multipliers.forEach(m => {
      if (m.type === 'value_map') {
        const numericVal = getSliderNumeric(m.source);
        const mult = m.values[numericVal];
        if (mult !== undefined) { low *= mult; high *= mult; }
      }
    });
  }
  const quantity = state.sliders[p.quantitySource] ? state.sliders[p.quantitySource].numeric : 1;
  low = Math.round(low * quantity);
  high = Math.round(high * quantity);
  const breakdown = [];
  const primaryOpt = findOption(p.basePriceStep, primaryAnswer);
  const primaryLabel = primaryOpt ? primaryOpt.label : primaryAnswer;
  let baseLine = primaryLabel;
  if (p.quantitySource && state.sliders[p.quantitySource]) {
    baseLine += ` (${state.sliders[p.quantitySource].raw}${getSliderUnit(p.quantitySource)}`;
    const baseStep = C.steps.find(s => s.input.type === 'slider_group' && s.input.sliders.some(sl => sl.id === p.quantitySource));
    if (baseStep) {
      baseStep.input.sliders.forEach(s => {
        if (s.id !== p.quantitySource && state.sliders[s.id]) baseLine += ` Ã— ${state.sliders[s.id].numeric}m`;
      });
    }
    baseLine += ')';
  }
  breakdown.push({ label: baseLine, low, high });
  let runningLow = low;
  let runningHigh = high;
  if (p.extras) {
    p.extras.forEach(extra => {
      if (!state.toggles[extra.id]) return;
      let extLow = 0, extHigh = 0;
      switch (extra.type) {
        case 'fixed': extLow = extra.low; extHigh = extra.high; break;
        case 'per_unit': extLow = Math.round(extra.lowPerUnit * quantity); extHigh = Math.round(extra.highPerUnit * quantity); break;
        case 'percentage': extLow = Math.round(runningLow * (extra.lowPercent / 100)); extHigh = Math.round(runningHigh * (extra.highPercent / 100)); break;
      }
      runningLow += extLow;
      runningHigh += extHigh;
      breakdown.push({ label: extra.breakdownLabel, low: extLow, high: extHigh, prefix: extra.type === 'percentage' ? '+' : '' });
    });
  }
  runningLow = Math.max(runningLow, p.minimumPrice || 0);
  runningHigh = Math.max(runningHigh, p.minimumPrice || 0);
  if (p.roundTo && p.roundTo > 0) {
    runningLow = Math.round(runningLow / p.roundTo) * p.roundTo;
    runningHigh = Math.round(runningHigh / p.roundTo) * p.roundTo;
  }
  return { low: runningLow, high: runningHigh, breakdown };
}

function findOption(stepId, value) {
  const step = C.steps.find(s => s.id === stepId);
  if (!step) return null;
  return step.input.options ? step.input.options.find(o => o.value === value) : null;
}

function getSliderUnit(sliderId) {
  for (const step of C.steps) {
    if (step.input.type === 'slider_group') {
      const s = step.input.sliders.find(sl => sl.id === sliderId);
      if (s) return s.unit || '';
    }
  }
  return '';
}

function formatPrice(low, high, prefix, isTotal) {
  prefix = prefix || '';
  if (C.pricing.displayMode === 'from') {
    return (prefix ? '+ ' : '') + (isTotal ? 'From ' : '') + '$' + low.toLocaleString();
  }
  return prefix + '$' + low.toLocaleString() + ' â€“ $' + high.toLocaleString();
}

function updateEstimate() {
  const est = calculateEstimate();
  const rangeEl = document.getElementById('estRange');
  const noteEl = document.getElementById('estNote');
  const breakdownEl = document.getElementById('estBreakdown');
  const estSectionIndex = C.steps.length;
  const previewEl = document.getElementById(`section-${estSectionIndex}-preview`);
  if (!rangeEl) return;
  if (!est) {
    rangeEl.textContent = 'â€”';
    noteEl.textContent = 'Complete the sections above to see your estimate';
    breakdownEl.innerHTML = '';
    if (previewEl) previewEl.textContent = C.estimate.preview;
    return;
  }
  const rangeText = formatPrice(est.low, est.high, '', true);
  rangeEl.textContent = rangeText;
  noteEl.textContent = C.estimate.note;
  if (C.pricing.showBreakdown && est.breakdown) {
    breakdownEl.innerHTML = est.breakdown.map(b => `
      <div class="breakdown-row">
        <span class="br-label">${b.label}</span>
        <span class="br-value">${formatPrice(b.low, b.high, b.prefix)}</span>
      </div>`).join('');
  }
  if (previewEl) previewEl.innerHTML = `<span class="selected">âœ“ ${rangeText}</span>`;
}

// â”€â”€ QUOTE SUMMARY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function buildQuoteSummaryText(includeHtml) {
  let lines = [];
  C.steps.forEach((step, i) => {
    // Skip hidden conditional steps
    if (step.showIf) {
      const section = document.getElementById(`section-${i}`);
      if (section && section.style.display === 'none') return;
    }
    if (step.input.type === 'select' && state.answers[step.id]) {
      const opt = findOption(step.id, state.answers[step.id]);
      if (includeHtml) {
        lines.push(`${opt ? opt.icon : 'â€¢'} ${step.title}: <strong>${opt ? opt.label : state.answers[step.id]}</strong>`);
      } else {
        lines.push(`${step.title}: ${opt ? opt.label : state.answers[step.id]}`);
      }
    }
    if (step.input.type === 'slider_group') {
      const vals = step.input.sliders.map(s => {
        const v = state.sliders[s.id];
        return v ? `${s.label}: ${v.label}` : '';
      }).filter(Boolean);
      if (includeHtml) {
        lines.push(`ğŸ“ ${vals.join(', ')}`);
      } else {
        lines.push(vals.join(', '));
      }
    }
    if (step.input.type === 'toggle_group') {
      const active = step.input.toggles.filter(t => state.toggles[t.id]);
      if (active.length) {
        if (includeHtml) {
          lines.push(`â• Extras: ${active.map(t => t.label).join(', ')}`);
        } else {
          lines.push(`Extras: ${active.map(t => t.label).join(', ')}`);
        }
      }
    }
  });
  const est = calculateEstimate();
  if (est) {
    const priceText = formatPrice(est.low, est.high, '', true);
    if (includeHtml) {
      lines.push(`ğŸ’° Estimate: <strong>${priceText}</strong>`);
    }
    // Price excluded from clipboard/email text â€” fencer should quote their own price
  }
  return lines;
}

function updateQuoteSummary() {
  const el = document.getElementById('quoteSummary');
  if (!el) return;
  const lines = buildQuoteSummaryText(true);
  el.innerHTML = lines.length ? lines.join('<br>') : 'Select your options above first';
}

// â”€â”€ COPY & EMAIL QUOTE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getPlainTextQuote() {
  const nameEl = document.getElementById('form-name');
  const suburbEl = document.getElementById('form-suburb');
  const notesEl = document.getElementById('form-notes');
  const name = nameEl ? nameEl.value.trim() : '';
  const suburb = suburbEl ? suburbEl.value.trim() : '';
  const notes = notesEl ? notesEl.value.trim() : '';

  let text = 'ğŸ—ï¸ FENCE QUOTE â€” READY FOR PRICING\n';
  text += 'â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n';

  if (name) text += `Name: ${name}\n`;
  if (suburb) text += `Suburb: ${suburb}\n`;
  if (name || suburb) text += '\n';

  const lines = buildQuoteSummaryText(false);
  text += lines.join('\n');

  if (notes) text += `\n\nNotes: ${notes}`;

  text += '\n\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n';
  text += 'Generated at itabs.ai/quotes\n';
  text += 'Please provide an accurate quote based on these specs.';

  return text;
}

function copyQuote() {
  const text = getPlainTextQuote();
  navigator.clipboard.writeText(text).then(() => {
    document.getElementById('leadFormContainer').style.display = 'none';
    document.getElementById('successMsg').style.display = 'block';
    document.getElementById('successTitle').textContent = 'Copied to clipboard! âœ…';
    document.getElementById('successText').textContent = 'Paste it into a text, email, or DM to any local fencer. They\'ll have everything they need to give you an accurate quote.';
    showFencerSuggestions();
    sendNotification(text);

    const leadSectionIndex = C.steps.length + (C.estimate ? 1 : 0);
    const sectionId = `section-${leadSectionIndex}`;
    document.getElementById(sectionId).classList.add('completed');
    state.completedSections.add(sectionId);
    document.getElementById(sectionId + '-preview').innerHTML = '<span class="selected">âœ“ Ready to send!</span>';
    updateProgress();
  }).catch(() => {
    // Fallback: select text for manual copy
    const textarea = document.createElement('textarea');
    textarea.value = text;
    textarea.style.position = 'fixed';
    textarea.style.opacity = '0';
    document.body.appendChild(textarea);
    textarea.select();
    document.execCommand('copy');
    document.body.removeChild(textarea);

    document.getElementById('leadFormContainer').style.display = 'none';
    document.getElementById('successMsg').style.display = 'block';
    showFencerSuggestions();
    sendNotification(text);
  });
}

function showFencerSuggestions() {
  if (!C.suggestedFencers || !C.suggestedFencers.length) return;
  const container = document.getElementById('fencerSuggestions');
  if (!container) return;
  let html = '<div style="margin-top:20px;padding-top:20px;border-top:1px solid var(--border);">';
  html += '<p style="color:var(--text-muted);font-size:0.9rem;margin-bottom:12px;">ğŸ’¬ Know a fencer? Or try one of these Perth companies:</p>';
  C.suggestedFencers.forEach(f => {
    const icon = f.type === 'facebook' ? 'ğŸ“˜' : 'ğŸŒ';
    html += `<a href="${f.link}" target="_blank" style="display:flex;align-items:center;gap:10px;padding:10px 14px;margin-bottom:8px;background:var(--bg-hover);border-radius:10px;text-decoration:none;color:var(--text-main);transition:background 0.2s;" onmouseover="this.style.background='var(--border)'" onmouseout="this.style.background='var(--bg-hover)'">${icon} <span><strong>${f.name}</strong>${f.area ? '<br><span style="font-size:0.8rem;color:var(--text-muted);">' + f.area + '</span>' : ''}</span></a>`;
  });
  html += '</div>';
  container.innerHTML = html;
}

function emailQuote() {
  const text = getPlainTextQuote();
  const subject = encodeURIComponent('My Fence Quote â€” Ready for Pricing');
  const body = encodeURIComponent(text);
  window.location.href = `mailto:?subject=${subject}&body=${body}`;
  sendNotification(text);
}

// â”€â”€ NOTIFICATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function sendNotification(quoteText) {
  if (!C.notification || !C.notification.enabled || C.notification.web3formsKey === 'YOUR_KEY_HERE') return;
  try {
    fetch('https://api.web3forms.com/submit', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        access_key: C.notification.web3formsKey,
        subject: 'ğŸ—ï¸ New fence quote from iTabs',
        from_name: 'iTabs Quotes',
        message: quoteText,
      })
    }).catch(() => {});
  } catch(e) {}
}

// â”€â”€ WARNINGS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function checkWarnings() {
  const answers = state.answers;
  C.steps.forEach((step, i) => {
    if (!step.warnings) return;
    step.warnings.forEach(w => {
      const elId = `section-${i}-warning-${w.condition.replace(/[^a-z0-9]/gi,'')}`;
      const el = document.getElementById(elId);
      if (!el) return;
      try {
        const show = eval(w.condition);
        el.style.display = show ? 'block' : 'none';
      } catch(e) { el.style.display = 'none'; }
    });
  });
}

// â”€â”€ PROGRESS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateProgress() {
  let hiddenSteps = 0;
  C.steps.forEach((step, i) => {
    if (step.showIf) {
      const section = document.getElementById(`section-${i}`);
      if (section && section.style.display === 'none') hiddenSteps++;
    }
  });
  const totalSections = C.steps.length - hiddenSteps + (C.estimate ? 1 : 0) + (C.leadCapture && C.leadCapture.enabled ? 1 : 0);
  const completed = state.completedSections.size;
  const pct = (completed / totalSections) * 100;
  const fillEl = document.getElementById('progressFill');
  const textEl = document.getElementById('progressText');
  if (fillEl) fillEl.style.width = pct + '%';
  if (textEl) textEl.textContent = `${completed} of ${totalSections}`;
}

// â”€â”€ PREVIEW HELPERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getPreview(step) {
  if (step.input.type === 'select' && state.answers[step.id]) {
    const opt = step.input.options.find(o => o.value === state.answers[step.id]);
    return `<span class="selected">âœ“ ${opt ? opt.label : state.answers[step.id]}</span>`;
  }
  return step.preview;
}

// â”€â”€ GO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
init();
</script>

</body>
</html>
